"""changement enjana

Revision ID: cb9c698c82d6
Revises: 
Create Date: 2024-05-14 15:23:55.165760

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = 'cb9c698c82d6'
down_revision = None
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('histogramme',
    sa.Column('ligne', sa.Integer(), nullable=False),
    sa.Column('annee', sa.Integer(), nullable=True),
    sa.Column('moi', sa.Integer(), nullable=True),
    sa.Column('libelle', sa.String(), nullable=True),
    sa.Column('montant', sa.Float(), nullable=True),
    sa.PrimaryKeyConstraint('ligne'),
    info={'is_view': True}
    )
    op.create_table('v_board',
    sa.Column('total', sa.Float(precision=2), nullable=False),
    sa.Column('paye', sa.Float(precision=2), nullable=True),
    sa.Column('reste', sa.Float(precision=2), nullable=True),
    sa.PrimaryKeyConstraint('total'),
    info={'is_view': True}
    )
    op.create_table('v_devis',
    sa.Column('iddevis', sa.Integer(), nullable=False),
    sa.Column('idclient', sa.String(), nullable=True),
    sa.Column('maison', sa.String(), nullable=True),
    sa.Column('finition', sa.String(), nullable=True),
    sa.Column('total', sa.Float(precision=2), nullable=True),
    sa.Column('paye', sa.Float(precision=2), nullable=True),
    sa.Column('reste', sa.Float(precision=2), nullable=True),
    sa.Column('debut', sa.Date(), nullable=True),
    sa.Column('fin', sa.Date(), nullable=True),
    sa.Column('lieu', sa.String(), nullable=True),
    sa.Column('reference', sa.String(), nullable=True),
    sa.PrimaryKeyConstraint('iddevis'),
    info={'is_view': True}
    )
    op.drop_table('moi')
    op.drop_table('typetravaux')
    op.drop_table('annee')
    with op.batch_alter_table('devis', schema=None) as batch_op:
        batch_op.add_column(sa.Column('reference', sa.String(), nullable=True))
        batch_op.add_column(sa.Column('lieu', sa.String(), nullable=True))

    with op.batch_alter_table('maison', schema=None) as batch_op:
        batch_op.add_column(sa.Column('surface', sa.Float(), nullable=True))

    with op.batch_alter_table('paiement', schema=None) as batch_op:
        batch_op.add_column(sa.Column('reference', sa.String(), nullable=True))

    with op.batch_alter_table('travaux', schema=None) as batch_op:
        batch_op.add_column(sa.Column('code', sa.String(), nullable=True))
        batch_op.drop_constraint('travaux_idtypetravaux_fkey', type_='foreignkey')
        batch_op.drop_column('idtypetravaux')

    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    with op.batch_alter_table('travaux', schema=None) as batch_op:
        batch_op.add_column(sa.Column('idtypetravaux', sa.INTEGER(), autoincrement=False, nullable=True))
        batch_op.create_foreign_key('travaux_idtypetravaux_fkey', 'typetravaux', ['idtypetravaux'], ['idtypetravaux'])
        batch_op.drop_column('code')

    with op.batch_alter_table('paiement', schema=None) as batch_op:
        batch_op.drop_column('reference')

    with op.batch_alter_table('maison', schema=None) as batch_op:
        batch_op.drop_column('surface')

    with op.batch_alter_table('devis', schema=None) as batch_op:
        batch_op.drop_column('lieu')
        batch_op.drop_column('reference')

    op.create_table('annee',
    sa.Column('annee', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('annee', name='annee_pkey')
    )
    op.create_table('typetravaux',
    sa.Column('idtypetravaux', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('libelle', sa.VARCHAR(), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('idtypetravaux', name='typetravaux_pkey')
    )
    op.create_table('moi',
    sa.Column('num', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('libelle', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('num', name='moi_pkey')
    )
    op.drop_table('v_devis')
    op.drop_table('v_board')
    op.drop_table('histogramme')
    # ### end Alembic commands ###
